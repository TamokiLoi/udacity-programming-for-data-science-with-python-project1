1. What is the total revenue generated by each store?
SELECT s.store_id, SUM(p.amount) AS total_revenue
FROM store s
JOIN inventory i ON s.store_id = i.store_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN payment p ON r.rental_id = p.rental_id
GROUP BY s.store_id
ORDER BY total_revenue DESC;


2. What are the average rental rates for each film category?
SELECT c.name AS category, AVG(f.rental_rate) AS average_rental_rate
FROM category c
JOIN film_category fc ON c.category_id = fc.category_id
JOIN film f ON fc.film_id = f.film_id
GROUP BY c.name
ORDER BY average_rental_rate DESC;


3. What is the distribution of films based on their rating across different categories?
SELECT c.name AS category, f.rating, COUNT(*) AS film_count
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
GROUP BY c.name, f.rating
ORDER BY c.name, film_count DESC;


4. What is the distribution of film lengths across different length categories (e.g., Short, Medium, Long)?
WITH LengthCategories AS (
    SELECT CASE
        WHEN length <= 60 THEN 'Short'
        WHEN length BETWEEN 61 AND 120 THEN 'Medium'
        ELSE 'Long'
    END AS length_category,
    COUNT(*) AS film_count
    FROM film
    GROUP BY length_category
)
SELECT length_category, film_count
FROM LengthCategories
ORDER BY film_count DESC;
